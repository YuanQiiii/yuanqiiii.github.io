<div class="toc collapsed">
    <button class="toc-toggle" aria-expanded="false" aria-label="Toggle table of contents">
        <span class="toc-toggle-icon">▶</span>
        <span class="toc-toggle-text">Table of Contents</span>
        <div class="reading-progress-ring">
            <svg width="24" height="24" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="var(--bg-2)" stroke-width="2" fill="none"/>
                <circle class="progress-circle" cx="12" cy="12" r="10" stroke="var(--primary-color)" stroke-width="2" fill="none"
                        stroke-dasharray="62.83" stroke-dashoffset="62.83"/>
            </svg>
            <span class="progress-text">0%</span>
        </div>
    </button>
    <div class="toc-content">
        <ul class="toc-list">
            {% for h1 in page.toc %}
                <li class="toc-item collapsible {% if h1.children %}has-children{% endif %}">
                    {% if h1.children %}
                        <button class="toc-item-toggle" aria-expanded="false" aria-label="Toggle section">
                            <span class="toc-item-icon">▶</span>
                        </button>
                    {% endif %}
                    <a href="{{ h1.permalink | safe }}">{{ h1.title }}</a>

                    {% if h1.children %}
                        <ul class="toc-children">
                        {% for h2 in h1.children %}
                            <li class="toc-item collapsible {% if h2.children %}has-children{% endif %}">
                                {% if h2.children %}
                                    <button class="toc-item-toggle" aria-expanded="false" aria-label="Toggle subsection">
                                        <span class="toc-item-icon">▶</span>
                                    </button>
                                {% endif %}
                                <a href="{{ h2.permalink | safe }}">{{ h2.title }}</a>

                                {% if h2.children %}
                                    <ul class="toc-children">
                                        {% for h3 in h2.children %}
                                            <li class="toc-item">
                                                <a href="{{ h3.permalink | safe }}">{{ h3.title }}</a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </li>
                        {% endfor %}
                        </ul>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
</div>
